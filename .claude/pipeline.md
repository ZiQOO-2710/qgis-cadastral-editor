# 워크플로우 파이프라인 템플릿

## GeoJSON 생성 파이프라인

### 기본 흐름
```
사용자 요청: "GeoJSON 재생성하고 검증해줘"

┌─────────────────────────────────────┐
│ 1단계: 병렬 분석 (동시 실행)        │
├─────────────────────────────────────┤
│ ┌─ Context7                         │
│ │   └─ QGIS 문서 검색               │
│ │                                    │
│ └─ Sequential                        │
│     └─ 현재 코드 분석                │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 2단계: 실행 (순차)                  │
├─────────────────────────────────────┤
│ Claude Code                          │
│   └─ QGIS Python 콘솔 실행 안내     │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 3단계: 병렬 검증 (동시 실행)        │
├─────────────────────────────────────┤
│ ┌─ Claude Code                      │
│ │   └─ 파일 존재 확인               │
│ │                                    │
│ └─ Sequential                        │
│     └─ 한글 인코딩 확인              │
└─────────────────────────────────────┘
```

### 체크리스트
- [ ] DBF 파일 인코딩 확인 (CP949)
- [ ] 좌표계 변환 (EPSG:5186 → EPSG:4326)
- [ ] GeoJSON 파일 생성 확인
- [ ] 한글 텍스트 깨짐 확인
- [ ] 면적 값 정확성 검증

---

## 웹 UI 개선 파이프라인

### 기본 흐름
```
사용자 요청: "필터 UI 개선해줘"

┌─────────────────────────────────────┐
│ 1단계: 병렬 분석                    │
├─────────────────────────────────────┤
│ ┌─ Context7                         │
│ │   └─ Leaflet UI 모범사례 검색    │
│ │                                    │
│ └─ Sequential                        │
│     └─ 현재 필터 구조 분석          │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 2단계: 구현                         │
├─────────────────────────────────────┤
│ Claude Code                          │
│   ├─ index.html 수정                │
│   └─ 로컬 서버로 테스트             │
└─────────────────────────────────────┘
```

### 체크리스트
- [ ] 현재 UI 구조 파악
- [ ] Leaflet 최신 패턴 확인
- [ ] HTML/CSS/JS 수정
- [ ] 브라우저 테스트
- [ ] 반응형 확인

---

## 멀티 AI 검증 파이프라인

### 기본 흐름
```
사용자 요청: "새 필터 기능 만들고 Codex로 검증해줘"

┌─────────────────────────────────────┐
│ 1단계: Claude Code가 코드 작성     │
├─────────────────────────────────────┤
│ Claude Code                          │
│   └─ index.html 필터 코드 생성      │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 2단계: Codex (GPT)가 검증          │
├─────────────────────────────────────┤
│ OpenAI Codex                         │
│   ├─ 코드 품질 분석                 │
│   ├─ 버그 탐지                      │
│   ├─ 보안 취약점 검사               │
│   └─ 최적화 제안                    │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 3단계: Claude Code가 개선           │
├─────────────────────────────────────┤
│ Claude Code                          │
│   └─ Codex 피드백 반영하여 수정    │
└─────────────────────────────────────┘
```

### 체크리스트
- [ ] 초기 코드 작성
- [ ] Codex 검증 실행
- [ ] 피드백 분석
- [ ] 코드 개선
- [ ] 최종 테스트

---

## 문제 해결 파이프라인

### 기본 흐름
```
사용자 요청: "왜 한글이 깨지는지 분석해줘"

┌─────────────────────────────────────┐
│ 1단계: Sequential 분석              │
├─────────────────────────────────────┤
│ Sequential Thinking                  │
│   ├─ 현재 상태 파악                 │
│   ├─ 인코딩 체인 추적               │
│   └─ 문제 지점 식별                 │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 2단계: Context7 검색                │
├─────────────────────────────────────┤
│ Context7                             │
│   └─ 인코딩 관련 문서 검색          │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 3단계: Claude Code 수정             │
├─────────────────────────────────────┤
│ Claude Code                          │
│   ├─ 인코딩 설정 수정               │
│   └─ 테스트 실행                    │
└─────────────────────────────────────┘
```

### 체크리스트
- [ ] 증상 정확히 파악
- [ ] 원인 분석 완료
- [ ] 해결책 문서화
- [ ] 수정 적용
- [ ] 재발 방지 확인

---

## 전체 프로젝트 파이프라인

### 새 지역 자동화 (무릉리 템플릿)
```
사용자 요청: "새 지역 토지조서 처리해줘"

┌─────────────────────────────────────┐
│ 1단계: 데이터 분석                  │
├─────────────────────────────────────┤
│ Sequential                           │
│   ├─ CSV 구조 파악                  │
│   ├─ PNU 코드 추출                  │
│   └─ 필지 목록 생성                 │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 2단계: 자동화 실행                  │
├─────────────────────────────────────┤
│ Claude Code                          │
│   ├─ config.yaml 생성               │
│   ├─ cadastral_auto.py 실행         │
│   └─ 웹맵 생성                      │
└─────────────────────────────────────┘
            ↓
┌─────────────────────────────────────┐
│ 3단계: 검증                         │
├─────────────────────────────────────┤
│ ┌─ Claude Code                      │
│ │   └─ 파일 검증                    │
│ │                                    │
│ └─ Codex (선택)                     │
│     └─ 코드 품질 검증               │
└─────────────────────────────────────┘
```

---

## 파이프라인 설정

### 타임아웃 설정
```yaml
timeouts:
  context7: 30s
  sequential: 60s
  codex: 120s
  claude_code: 300s
```

### 재시도 정책
```yaml
retry:
  max_attempts: 3
  backoff: exponential
  on_timeout: skip_to_next
```

### 로깅
```yaml
logging:
  level: info
  output: .claude/logs/
  format: "[{timestamp}] [{agent}] {message}"
```
